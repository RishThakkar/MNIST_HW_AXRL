#include <stdio.h>
#include <time.h>
#include <stdlib.h>
#include <math.h>

#ifndef FUNCTIONS_H
#define FUNCTIONS_H
#define IMAGE_HEIGHT 42
#define IMAGE_WIDTH  42

int current_height = IMAGE_HEIGHT;
int current_width = IMAGE_WIDTH;


float weights_bias[] = {0.25, -2.5, 0, 1.5,             //Conv 1 Weights
                        -0.25, -2.5, 0.25, 1.75,        
                        0.25, -2.75, -0.25, 1.75,
                        0, -2.25, 0.25, 2.25,
                        -0.25, -2.5, -0.25, 2,
                        -0.25, -2.75, -0.25, 2.25,
                        0, -2.25, -0.25, 1.25,
                        -0.25, -2.5, 0.25, 2,
                        0.25, -1.75, -0.25, 2,
                        0, 0, 0, 0,                 //Biases
                        -0.25, 0, 0.25, -0.25,          //Conv 2 Weights
                        -0.5, 1.25, 0.25, 0.75,
                        0, 0, 0, -0.25,
                        0.75, -2, -0.25, 0,
                        0.25, 0.25, -0.25, 0,
                        -0.5, 1, 0, -0.25,
                        0.25, -0.25, 0.25, 0,
                        0.25, -1.5, 0, 0.75,
                        0, 0.25, 0, 0,
                        0.5, 1.25, -0.25, -0.25,
                        0, -0.25, 0, 0,
                        -0.25, -1.75, 0.25, 0.75,
                        0, 0.25, -0.25, -0.25,
                        -1.25, 0.75, 0, -0.75,
                        0.25, 0, 0, 0,
                        1.25, -2.25, 0, 1.25,
                        0, 0.25, 0, 0,
                        -1.5, 1, -0.25, -1.75,
                        -0.25, 0, -0.25, 0,
                        1.25, -1.75, 0, 1.25,
                        0.25, 0, 0, 0.25,
                        -1, 1, 0.25, -1.25,
                        -0.25, -0.25, 0, 0,
                        1, -2.5, 0, 1.5,
                        -0.25, 0, 0.25, -0.25,
                        -0.5, 0.75, -0.25, 0,
                        0, 0.25, 0, -0.25,
                        1, -1.75, 0, 0.75,
                        0, -0.25, -0.25, 0,
                        -1.25, 1, 0, -0.75,
                        0, 0, -0.25, 0,
                        1.25, -1.75, -0.25, 1,
                        0.25, -0.25, 0, -0.25,
                        -0.75, 1.25, 0, -1,
                        0, 0.25, 0, 0.25,
                        1.5, -1.25, 0, 1.25,
                        0, 0.25, 0, 0,                  //Bias
                        -0.5, 0, 0, 0.5, 0, -0.5, 0, -0.25, -0.25, -0.25,       //Dense Layer Weights (Can be wrong) Check once
                        0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                        0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                        -0.5, 0.25, 0, 0.5, 0.25, -0.5, 0.25, -0.25, -0.5, -0.25,
                        -0.5, 0, 0.5, 0.75, -0.25, -0.5, 0.5, -0.75, -0.75, -1,
                        0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                        0, 0, 0, 0, 0, 0, 0, 0, 0, 0.25,
                        -0.25, 0, 0.25, 0.75, -0.25, -0.5, 0.25, -0.5, -0.5, -1.25,
                        -0.5, -0.75, 0.75, 0.75, -1, -0.25, 0.75, -1.25, -0.25, -1.5,
                        0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                        0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                        -0.5, -0.25, 0.5, 0.5, -0.75, -0.25, 0.5, -1.5, -0.25, -2,
                        0, 0, 0.75, 0.5, -1.25, 0, 0.5, -2, 0.25, -1.75,
                        0, 0, -0.25, 0, 0, 0, 0, 0, 0, 0,
                        0, 0, 0, 0, 0, 0, 0, 0, -0.25, 0.25,
                        0, 0.25, 0.75, 0.5, -0.75, 0, 0.25, -2, 0.25, -2,
                        0.25, 0.5, 0.75, 0.5, -1.25, 0, 0.25, -2.5, 0.5, -2,
                        0, 0, -0.25, 0, 0, 0, 0, 0, 0, 0,
                        0, -0.25, 0, 0, 0, 0, 0, 0, 0, -0.25,
                        0.25, 0.5, 0.5, 0.5, -0.75, 0, 0.5, -2.5, 0.5, -2,
                        0.25, 0, 0.75, 0.25, -0.75, 0.25, 0.75, -2.75, 0.5, -2.25,
                        0, 0, 0, 0, 0, 0, -0.25, 0, 0, 0.25,
                        0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                        0.25, 0, 0.5, 0.25, -0.25, 0, 0.5, -3, 0.5, -2.5,
                        0, 0.25, 0.25, 0, -0.25, 0.25, 1, -2.75, 0.25, -2.5,
                        0, 0, 0, 0, 0, 0, -0.25, 0, 0, 0,
                        0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                        -0.25, 0.5, -0.5, -1, 0.5, 0.25, 1.25, -2.75, 0, -2.5,
                        -0.75, 0.25, -1.25, -1.5, 0.5, 0.5, 1, -1, -0.25, -1.25,
                        0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                        0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                        -0.75, 0, 0.25, 1, 0.5, -1, -0.5, 0.5, -0.75, -1.5,
                        -0.5, -0.75, 0.5, 0.75, 0.25, -0.25, -0.25, 0.75, -0.25, -1.5,
                        0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                        0, 0, 0, 0, -0.25, 0, 0, 0, 0, 0,
                        -0.25, -0.75, 0.5, 0.75, 0.25, -0.25, -0.25, 0.5, -0.25, -1.5,
                        -0.25, -1, 0.5, 0.5, 0, 0.25, -0.25, 0.25, 0.25, -0.5,
                        0, 0, -0.25, -0.25, 0, 0, 0, 0, 0, 0,
                        0, 0, 0, 0, 0.25, 0, 0, 0, 0, 0,
                        -0.25, -1, 0.25, 0.5, 0, 0, -0.25, 0.25, 0.25, -0.5,
                        0, -0.25, 0.25, 0.25, -0.25, 0.25, -0.25, 0, 0.25, 0,
                        0.25, 0, -0.25, -0.75, 0.25, 0.25, 0.25, 0, 0, 0.25,
                        0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                        0, -0.25, 0.25, 0.25, 0, 0, -0.25, -0.25, 0.25, 0,
                        0, 0.25, -0.5, -0.75, 0.5, 0.25, 0.5, 0.5, -0.75, 0,
                        0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                        0.25, 0, 0.25, 0.25, -0.5, 0, 0, -0.25, 0, 0.25,
                        0.25, 0, 0.25, 0, -0.5, 0, -0.25, -0.25, 0, 0.25,
                        -0.75, 0.75, -0.25, 0, 0.25, 0.25, 0.25, 0.5, -1, -0.25,
                        0.25, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                        0.25, 0, 0, 0, -0.25, 0, -0.25, -0.25, 0, 0,
                        0.25, 0.25, 0, 0.5, 0.25, 0, 0.5, -1, -0.75, -0.75,
                        0, 0, 0, 0, 0, 0, 0, 0, 0, -0.25,
                        0, 0, 0, 0, -0.5, -0.25, 0.25, 1, -0.25, -1,
                        -0.75, -0.25, 0.25, 1, -0.25, -1.5, -1.25, 1, -0.25, -1.25,
                        0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                        0.25, -0.25, 0, 0.25, 0, 0, 0, 0, 0, 0,
                        -0.5, -0.25, 0.25, 1, -0.25, -1, -0.75, 1, -0.25, -1,
                        -0.5, -0.5, 0, 0.25, -0.25, -0.25, -0.5, 0.5, 0.25, -0.25,
                        0, 0, 0, -0.25, 0, 0, 0, -0.25, 0, 0,
                        0, 0, 0, 0, 0, 0.25, 0, 0, -0.25, 0,
                        0.25, -0.25, 0, 0, -0.25, 0.25, -0.75, 0.25, 0.25, -0.25,
                        0.5, -1.5, -0.5, -0.75, 0, 1.25, -1, -0.5, 0.75, -1.25,
                        0, 0, 0, 0, 0, -0.25, 0, 0, 0, 0,
                        0.25, 0.25, 0, 0, -0.5, 0, 0, 0.25, 0, 0,
                        0.25, 0.25, 0, 0.25, -0.5, -0.25, -0.5, 0.25, -0.25, 0,
                        -0.75, 1, 0.25, -0.25, 1, 0.5, 0.5, -1, -0.25, -2.25,
                        0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                        0.25, 0.25, 0, 0, -0.5, 0, 0, 0.25, 0, 0,
                        0.25, 0.25, 0, 0.25, -0.5, -0.25, -0.5, 0.25, -0.25, 0,
                        -0.75, 1, 0, -1.25, 0.75, 0.5, 1.25, -1, 0, -1.75,
                        0, 0, 0, 0, 0, 0, 0, 0, 0, -0.25,
                        0.25, 0, 0, 0, -0.25, 0, -0.5, 0.25, -0.25, 0,
                        0.25, -0.25, 0, 0.25, 0, 0, -1, 0.25, 0, 0.25,
                        -1, 0.5, 0, 0, 0, 0, 0.75, -0.25, -0.75, 0,
                        0, 0, 0, 0, 0, 0, -0.75, 0.25, 0.25, 0.25,
                        0, 0, 0, 0, -0.25, 0.25, -1, 0.25, 0.25, 0,
                        };         
float image[] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,84,190,190,159,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,84,190,190,159,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,160,252,252,215,6,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,38,38,64,6,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,134,252,252,253,63,63,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,38,38,64,6,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,134,252,252,253,63,63,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,192,192,252,161,161,35,0,0,0,0,0,0,0,0,0,0,0,0,0,0,126,252,252,253,186,186,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,193,193,253,253,253,84,0,0,0,0,0,0,0,0,0,0,0,0,0,0,169,253,253,254,218,218,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,193,193,253,253,253,84,0,0,0,0,0,0,0,0,0,0,0,0,0,0,169,253,253,254,218,218,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,104,104,252,252,252,189,18,18,0,0,0,0,0,0,0,0,0,0,0,0,126,252,252,253,252,252,65,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,48,48,247,252,252,247,47,47,0,0,0,0,0,0,0,0,0,0,0,0,160,252,252,253,252,252,29,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,48,48,247,252,252,247,47,47,0,0,0,0,0,0,0,0,0,0,0,0,160,252,252,253,252,252,29,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,29,29,232,252,252,252,77,77,0,0,0,0,0,0,0,0,0,0,0,0,64,252,252,253,252,252,56,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,25,25,226,252,252,252,129,129,0,0,0,0,0,0,0,0,0,0,0,0,37,235,235,253,252,252,161,106,106,62,0,0,0,0,0,0,0,0,0,0,0,0,25,25,226,252,252,252,129,129,0,0,0,0,0,0,0,0,0,0,0,0,37,235,235,253,252,252,161,106,106,62,0,0,0,0,0,0,0,0,0,0,0,0,43,43,253,253,253,253,253,253,254,253,253,253,253,253,253,255,255,253,253,253,253,253,253,255,253,253,253,253,253,147,0,0,0,0,0,0,0,0,0,0,0,0,11,11,205,252,252,252,252,252,253,252,252,252,252,252,252,253,253,252,252,252,252,252,252,253,252,252,252,252,252,155,0,0,0,0,0,0,0,0,0,0,0,0,11,11,205,252,252,252,252,252,253,252,252,252,252,252,252,253,253,252,252,252,252,252,252,253,252,252,252,252,252,155,0,0,0,0,0,0,0,0,0,0,0,0,0,0,51,134,134,231,231,231,232,238,238,244,252,252,235,232,232,231,231,231,231,249,249,253,252,252,197,56,56,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,28,28,49,84,84,14,0,0,0,0,0,0,211,211,253,252,252,187,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,28,28,49,84,84,14,0,0,0,0,0,0,211,211,253,252,252,187,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,124,124,253,252,252,240,35,35,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,107,107,255,253,253,245,49,49,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,107,107,255,253,253,245,49,49,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,62,62,253,252,252,252,128,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,97,97,245,252,252,252,186,186,13,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,97,97,245,252,252,252,186,186,13,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,155,189,189,189,189,189,66,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};

// int numElements = sizeof(image) / sizeof(image[0]);

float out[6400];


float* add_weights(int num_weights);
float* add_biases(int num_biases);

void read_image(float image[IMAGE_HEIGHT][IMAGE_WIDTH]);

void conv(float image[IMAGE_HEIGHT][IMAGE_WIDTH] , float *weights, float output[IMAGE_HEIGHT-2][IMAGE_WIDTH-2]);


void relu(float input[IMAGE_HEIGHT-2][IMAGE_WIDTH-2], float output[IMAGE_HEIGHT-2][IMAGE_WIDTH-2]);

void max_pool(float input[IMAGE_HEIGHT-2][IMAGE_WIDTH-2], float output[(IMAGE_HEIGHT-2)/2][(IMAGE_WIDTH-2)/2]);

// void conv(float, float *, float);
// void basic_ques(int num_parameters, int num_weights, int num_biases);

void HW(float *weights, int weights_address, int weights_size, float *data, int data_address, int data_size,  int layer_index, float *out);

void printArray(float *arr, int size);

void printFeatureMaps(float *arr, int height, int width, int channels);



#endif
